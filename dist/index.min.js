"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=_default;var _template=_interopRequireDefault(require("@babel/template"));function _interopRequireDefault(n){return n&&n.__esModule?n:{default:n}}function defineBinaryPrimitives(n){return(0,_template.default)("const __binary__primitives = {\n        '".concat(n,".+'(a, b) { return a + b },\n        '").concat(n,".-'(a, b) { return a - b },\n        '").concat(n,".*'(a, b) { return a * b },\n        '").concat(n,"./'(a, b) { return a / b },\n        '").concat(n,".%'(a, b) { return a / b },\n        '").concat(n,".^'(a, b) { return a ^ b },\n        '").concat(n,".|'(a, b) { return a | b },\n        '").concat(n,".&'(a, b) { return a & b },\n        '").concat(n,".||'(a, b) { return a || b },\n        '").concat(n,".&&'(a, b) { return a && b },\n        '").concat(n,".=='(a, b) { return a == b },\n        '").concat(n,".!='(a, b) { return a != b },\n        '").concat(n,".==='(a, b) { return a === b },\n        '").concat(n,".!=='(a, b) { return a !== b },\n        '").concat(n,".>'(a, b) { return a > b },\n        '").concat(n,".>='(a, b) { return a >= b },\n        '").concat(n,".<'(a, b) { return a < b },\n        '").concat(n,".<='(a, b) { return a <= b },\n        '").concat(n,".>>'(a, b) { return a >> b },\n        '").concat(n,".<<'(a, b) { return a << b },\n        '").concat(n,".**'(a, b) { return a ** b },\n        '").concat(n,".instanceof'(a, b) { return a instanceof b },\n        '").concat(n,".in'(a, b) { return a in b }\n    }"))}function defineUnaryPrimitives(n){return(0,_template.default)("const __unary__primitives = {\n        '".concat(n,".+'(a) { return +a },\n        '").concat(n,".-'(a) { return -a },\n        '").concat(n,".++'(a) { return ++a },\n        '").concat(n,".--'(a) { return --a },\n        '").concat(n,".~'(a) { return ~a },\n        '").concat(n,".!'(a) { return !a },\n        '").concat(n,".typeof'(a) { return typeof a },\n        '").concat(n,".void'(a) { return void a }\n    }"))}function bop(n){return(0,_template.default)("\n        function _bop(LEFT, RIGHT, OPERATOR) {\n            if (LEFT !== null && LEFT !== void 0 && LEFT.constructor[OPERATOR]) {\n                return LEFT.constructor[OPERATOR](LEFT, RIGHT);\n            }\n    \n            if (RIGHT !== null && RIGHT !== void 0 && RIGHT.constructor[OPERATOR]) {\n                return RIGHT.constructor[OPERATOR](LEFT, RIGHT);\n            }\n            \n            return ".concat(n,"[OPERATOR](LEFT, RIGHT);\n        }\n    "))}function uop(n){return(0,_template.default)("\n        function _uop(ARG, OPERATOR) {\n            if (ARG !== null && ARG !== void 0 && ARG.constructor[OPERATOR]) {\n                return ARG.constructor[OPERATOR](ARG);\n            }\n            return ".concat(n,"[OPERATOR](ARG);\n        }\n    "))}function _default(n){var o=n.types;return{visitor:{Program:function(n,e){var t=e.opts.prefixes,r="unary",a="binary";t&&(r=t.unary||r,a=t.binary||a),this.unaryPrefix=r,this.binaryPrefix=a;var i=defineBinaryPrimitives(this.binaryPrefix)(),o=defineUnaryPrimitives(this.unaryPrefix)();i.declarations[0].id=n.scope.generateUidIdentifierBasedOnNode(i.declarations[0].id),o.declarations[0].id=n.scope.generateUidIdentifierBasedOnNode(o.declarations[0].id),this.bop=bop(i.declarations[0].id.name)({LEFT:n.scope.generateUidIdentifier("left"),RIGHT:n.scope.generateUidIdentifier("right"),OPERATOR:n.scope.generateUidIdentifier("operator")}),this.uop=uop(o.declarations[0].id.name)({ARG:n.scope.generateUidIdentifier("arg"),OPERATOR:n.scope.generateUidIdentifier("operator")}),this.bop.id=n.scope.generateUidIdentifierBasedOnNode(this.bop.id),this.uop.id=n.scope.generateUidIdentifierBasedOnNode(this.uop.id),n.unshiftContainer("body",i),n.unshiftContainer("body",o),n.unshiftContainer("body",this.bop),n.unshiftContainer("body",this.uop)},FunctionDeclaration:function(n){n.node.id.name!==this.bop.id.name&&n.node.id.name!==this.uop.id.name||n.skip()},"BinaryExpression|LogicalExpression":function(n){null!=n.node.loc?n.replaceWith(o.callExpression(this.bop.id,[n.node.left,n.node.right,o.stringLiteral("".concat(this.binaryPrefix,".").concat(n.node.operator))])):n.skip()},UnaryExpression:function(n){if(null!=n.node.loc){var e=o.stringLiteral("".concat(this.unaryPrefix,".").concat(n.node.operator));n.replaceWith(o.callExpression(this.uop.id,[n.node.argument,e]))}else n.skip()},UpdateExpression:function(n){if(null!=n.node.loc){var e=o.stringLiteral("".concat(this.unaryPrefix,".").concat(n.node.operator));n.replaceWith(o.assignmentExpression("=",n.node.argument,o.callExpression(this.uop.id,[n.node.argument,e])))}else n.skip()},AssignmentExpression:function(n){if(null!=n.node.loc){var e=new Set(["+=","-=","*=","/=","%=","|=","&=","^=",">>=","<<=","**="]),t=n.node.operator;if(e.has(t)){var r=t.substring(0,t.length-1),a=o.stringLiteral("binary.".concat(r)),i=o.callExpression(this.bop.id,[n.node.left,n.node.right,a]);n.replaceWith(o.assignmentExpression("=",n.node.left,i))}}else n.skip()},TemplateLiteral:function(n){n.node.expressions=n.node.expressions&&n.node.expressions.map(function(n){return o.callExpression(o.identifier("String"),[n])})}}}}